{"ast":null,"code":"import _defineProperty from\"/Users/anthonybeesley/Documents/Anthony/Coding Bootcamp/course_work/project_17/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/anthonybeesley/Documents/Anthony/Coding Bootcamp/course_work/project_17/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/anthonybeesley/Documents/Anthony/Coding Bootcamp/course_work/project_17/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/anthonybeesley/Documents/Anthony/Coding Bootcamp/course_work/project_17/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/anthonybeesley/Documents/Anthony/Coding Bootcamp/course_work/project_17/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{addActivityToRoutine,updateRoutine,getRoutineActivitiesByRoutineId,deleteRoutineActivity}from'../api';import MyRoutinesActivitiesForm from'./MyRoutinesActivitiesForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MyRoutinesItemEdit=function MyRoutinesItemEdit(_ref){var fetchData=_ref.fetchData,pendingActivities=_ref.pendingActivities,setPendingActivities=_ref.setPendingActivities,checkRoutineList=_ref.checkRoutineList,setToggle=_ref.setToggle,toggle=_ref.toggle,name=_ref.name,goal=_ref.goal,isPublic=_ref.isPublic,id=_ref.id;var initialState={name:name,goal:goal,isPublic:isPublic};var _useState=useState(_objectSpread({},initialState)),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),routineActivities=_useState4[0],setRoutineActivities=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var fetchRoutineData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fetchedRoutineActivities;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getRoutineActivitiesByRoutineId(id);case 3:fetchedRoutineActivities=_context.sent;if(fetchedRoutineActivities){_context.next=6;break;}return _context.abrupt(\"return\");case 6:setRoutineActivities(fetchedRoutineActivities);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function fetchRoutineData(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchRoutineData();},[]);var handleFormChange=function handleFormChange(event){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},event.target.name,event.target.value)));};var handleOptionChange=function handleOptionChange(event){var isPublicValue;if(event.target.value=='true'){isPublicValue=true;}else if(event.target.value=='false'){isPublicValue=false;}setForm(_objectSpread(_objectSpread({},form),{},{isPublic:isPublicValue}));};var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var name,goal,isPublic;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();setErrorMessage('');name=form.name,goal=form.goal,isPublic=form.isPublic;if(!(checkRoutineList(name)&&name!==name)){_context2.next=6;break;}setErrorMessage('This routine already exists! Please choose another name.');return _context2.abrupt(\"return\");case 6:_context2.prev=6;if(!(pendingActivities.length>0)){_context2.next=10;break;}_context2.next=10;return Promise.all(pendingActivities.map(function(_ref4){var routineId=_ref4.routineId,activityId=_ref4.activityId,count=_ref4.count,duration=_ref4.duration;addActivityToRoutine(routineId,activityId,count,duration);}));case 10:_context2.next=12;return updateRoutine(name,goal,isPublic,id);case 12:setPendingActivities([]);setToggle(!toggle);fetchData();_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](6);console.error(_context2.t0);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[6,17]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();var handleCancel=function handleCancel(){setToggle(!toggle);setForm(_objectSpread({},initialState));setPendingActivities([]);fetchData();};var handleDelete=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(routineActivityId){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return deleteRoutineActivity(routineActivityId);case 2:fetchRoutineData();case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleDelete(_x2){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Edit Routine:\"}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Routine name: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:form.name,onChange:handleFormChange})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Routine goal: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"goal\",value:form.goal,onChange:handleFormChange})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Share your routine?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-radio\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"isPublic\",value:\"false\",onChange:handleOptionChange,checked:form.isPublic===false}),\" Private\",/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"isPublic\",value:\"true\",onChange:handleOptionChange,checked:form.isPublic===true}),\" Public\"]})]}),/*#__PURE__*/_jsx(\"ul\",{children:routineActivities.length>0?routineActivities.map(function(_ref6){var name=_ref6.name,count=_ref6.count,duration=_ref6.duration,routineActivityId=_ref6.routineActivityId;return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"material-icons\",onClick:function onClick(){return handleDelete(routineActivityId);},children:\"delete\"}),\" \",name,\" (\",count,\" \",count>1?'reps':'rep',\" for \",duration,\" \",duration>1?'mins':'min',\")\"]},routineActivityId);}):null}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Add activities to your routine: \"}),/*#__PURE__*/_jsx(MyRoutinesActivitiesForm,{id:id,pendingActivities:pendingActivities,setPendingActivities:setPendingActivities,routineActivities:routineActivities,errorMessage:errorMessage,setErrorMessage:setErrorMessage})]}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMessage}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Update routine\",disabled:errorMessage?true:false,onClick:handleSubmit}),/*#__PURE__*/_jsx(\"input\",{type:\"button\",value:\"Cancel\",onClick:handleCancel})]});};export default MyRoutinesItemEdit;","map":{"version":3,"sources":["/Users/anthonybeesley/Documents/Anthony/Coding Bootcamp/course_work/project_17/src/components/MyRoutinesItemEdit.jsx"],"names":["React","useEffect","useState","addActivityToRoutine","updateRoutine","getRoutineActivitiesByRoutineId","deleteRoutineActivity","MyRoutinesActivitiesForm","MyRoutinesItemEdit","fetchData","pendingActivities","setPendingActivities","checkRoutineList","setToggle","toggle","name","goal","isPublic","id","initialState","form","setForm","routineActivities","setRoutineActivities","errorMessage","setErrorMessage","fetchRoutineData","fetchedRoutineActivities","console","log","handleFormChange","event","target","value","handleOptionChange","isPublicValue","handleSubmit","preventDefault","length","Promise","all","map","routineId","activityId","count","duration","error","handleCancel","handleDelete","routineActivityId"],"mappings":"u9BAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,CAA0BC,QAA1B,KAAyC,OAAzC,CAEA,OAAQC,oBAAR,CAA8BC,aAA9B,CAA6CC,+BAA7C,CAA8EC,qBAA9E,KAA0G,QAA1G,CACA,MAAOC,CAAAA,wBAAP,KAAqC,4BAArC,C,wFAEA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,MAAyH,IAAvHC,CAAAA,SAAuH,MAAvHA,SAAuH,CAA5GC,iBAA4G,MAA5GA,iBAA4G,CAAzFC,oBAAyF,MAAzFA,oBAAyF,CAAnEC,gBAAmE,MAAnEA,gBAAmE,CAAjDC,SAAiD,MAAjDA,SAAiD,CAAtCC,MAAsC,MAAtCA,MAAsC,CAA9BC,IAA8B,MAA9BA,IAA8B,CAAxBC,IAAwB,MAAxBA,IAAwB,CAAlBC,QAAkB,MAAlBA,QAAkB,CAARC,EAAQ,MAARA,EAAQ,CAChJ,GAAMC,CAAAA,YAAY,CAAG,CACjBJ,IAAI,CAAEA,IADW,CAEjBC,IAAI,CAAEA,IAFW,CAGjBC,QAAQ,CAAEA,QAHO,CAArB,CAMA,cAAwBf,QAAQ,kBAAKiB,YAAL,EAAhC,wCAAOC,IAAP,eAAaC,OAAb,eAEA,eAAkDnB,QAAQ,CAAC,EAAD,CAA1D,yCAAOoB,iBAAP,eAA0BC,oBAA1B,eAEA,eAAwCrB,QAAQ,CAAC,IAAD,CAAhD,yCAAOsB,YAAP,eAAqBC,eAArB,eAEA,GAAMC,CAAAA,gBAAgB,2FAAG,sMAEsBrB,CAAAA,+BAA+B,CAACa,EAAD,CAFrD,QAEXS,wBAFW,kBAGZA,wBAHY,iEAIjBJ,oBAAoB,CAACI,wBAAD,CAApB,CAJiB,+EAMjBC,OAAO,CAACC,GAAR,cANiB,oEAAH,kBAAhBH,CAAAA,gBAAgB,2CAAtB,CAUAzB,SAAS,CAAC,UAAM,CACZyB,gBAAgB,GACnB,CAFQ,CAEN,EAFM,CAAT,CAIA,GAAMI,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,KAAD,CAAW,CAChCV,OAAO,gCAAKD,IAAL,wBAAYW,KAAK,CAACC,MAAN,CAAajB,IAAzB,CAAgCgB,KAAK,CAACC,MAAN,CAAaC,KAA7C,GAAP,CACH,CAFD,CAIA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACH,KAAD,CAAW,CAClC,GAAII,CAAAA,aAAJ,CACA,GAAIJ,KAAK,CAACC,MAAN,CAAaC,KAAb,EAAsB,MAA1B,CAAkC,CAC9BE,aAAa,CAAG,IAAhB,CACH,CAFD,IAEO,IAAIJ,KAAK,CAACC,MAAN,CAAaC,KAAb,EAAsB,OAA1B,CAAmC,CACtCE,aAAa,CAAG,KAAhB,CACH,CACDd,OAAO,gCAAKD,IAAL,MAAWH,QAAQ,CAAEkB,aAArB,GAAP,CACH,CARD,CAUA,GAAMC,CAAAA,YAAY,2FAAG,kBAAOL,KAAP,6IACjBA,KAAK,CAACM,cAAN,GACAZ,eAAe,CAAC,EAAD,CAAf,CACOV,IAHU,CAGcK,IAHd,CAGVL,IAHU,CAGJC,IAHI,CAGcI,IAHd,CAGJJ,IAHI,CAGEC,QAHF,CAGcG,IAHd,CAGEH,QAHF,MAIbL,gBAAgB,CAACG,IAAD,CAAhB,EAA0BA,IAAI,GAAKA,IAJtB,2BAKbU,eAAe,CAAC,0DAAD,CAAf,CALa,+DASTf,iBAAiB,CAAC4B,MAAlB,CAA2B,CATlB,oDAUHC,CAAAA,OAAO,CAACC,GAAR,CACF9B,iBAAiB,CAAC+B,GAAlB,CAAsB,eAA8C,IAA5CC,CAAAA,SAA4C,OAA5CA,SAA4C,CAAjCC,UAAiC,OAAjCA,UAAiC,CAArBC,KAAqB,OAArBA,KAAqB,CAAdC,QAAc,OAAdA,QAAc,CAChE1C,oBAAoB,CAACuC,SAAD,CAAYC,UAAZ,CAAwBC,KAAxB,CAA+BC,QAA/B,CAApB,CACH,CAFD,CADE,CAVG,iCAgBPzC,CAAAA,aAAa,CAACW,IAAD,CAAOC,IAAP,CAAaC,QAAb,CAAuBC,EAAvB,CAhBN,SAiBbP,oBAAoB,CAAC,EAAD,CAApB,CACAE,SAAS,CAAC,CAACC,MAAF,CAAT,CACAL,SAAS,GAnBI,qFAqBbmB,OAAO,CAACkB,KAAR,eArBa,uEAAH,kBAAZV,CAAAA,YAAY,6CAAlB,CAyBA,GAAMW,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvBlC,SAAS,CAAC,CAACC,MAAF,CAAT,CACAO,OAAO,kBAAKF,YAAL,EAAP,CACAR,oBAAoB,CAAC,EAAD,CAApB,CACAF,SAAS,GACZ,CALD,CAOA,GAAMuC,CAAAA,YAAY,2FAAG,kBAAOC,iBAAP,6IACX3C,CAAAA,qBAAqB,CAAC2C,iBAAD,CADV,QAEjBvB,gBAAgB,GAFC,wDAAH,kBAAZsB,CAAAA,YAAY,8CAAlB,CAKA,mBACI,qCACI,qCADJ,cAEI,sCACI,wCADJ,cAEI,cAAO,IAAI,CAAC,MAAZ,CAAmB,IAAI,CAAC,MAAxB,CAA+B,KAAK,CAAE5B,IAAI,CAACL,IAA3C,CAAiD,QAAQ,CAAEe,gBAA3D,EAFJ,GAFJ,cAMI,sCACI,wCADJ,cAEI,cAAO,IAAI,CAAC,MAAZ,CAAmB,IAAI,CAAC,MAAxB,CAA+B,KAAK,CAAEV,IAAI,CAACJ,IAA3C,CAAiD,QAAQ,CAAEc,gBAA3D,EAFJ,GANJ,cAUI,sCACI,6CADJ,cAEI,aAAK,SAAS,CAAC,aAAf,wBACI,cAAO,IAAI,CAAC,OAAZ,CAAoB,IAAI,CAAC,UAAzB,CAAoC,KAAK,CAAC,OAA1C,CAAkD,QAAQ,CAAEI,kBAA5D,CAAgF,OAAO,CAAEd,IAAI,CAACH,QAAL,GAAkB,KAA3G,EADJ,yBAEI,cAAO,IAAI,CAAC,OAAZ,CAAoB,IAAI,CAAC,UAAzB,CAAoC,KAAK,CAAC,MAA1C,CAAiD,QAAQ,CAAEiB,kBAA3D,CAA+E,OAAO,CAAEd,IAAI,CAACH,QAAL,GAAkB,IAA1G,EAFJ,aAFJ,GAVJ,cAiBI,oBACCK,iBAAiB,CAACgB,MAAlB,CAA2B,CAA3B,CAA+BhB,iBAAiB,CAACmB,GAAlB,CAAsB,eAAgD,IAA9C1B,CAAAA,IAA8C,OAA9CA,IAA8C,CAAxC6B,KAAwC,OAAxCA,KAAwC,CAAjCC,QAAiC,OAAjCA,QAAiC,CAAvBI,iBAAuB,OAAvBA,iBAAuB,CAClG,mBACI,mCACI,aAAM,SAAS,CAAC,gBAAhB,CAAiC,OAAO,CAAE,yBAAMD,CAAAA,YAAY,CAACC,iBAAD,CAAlB,EAA1C,oBADJ,KACoGlC,IADpG,MAC4G6B,KAD5G,KACoHA,KAAK,CAAG,CAAR,CAAY,MAAZ,CAAqB,KADzI,SACqJC,QADrJ,KACgKA,QAAQ,CAAG,CAAX,CAAe,MAAf,CAAwB,KADxL,OAASI,iBAAT,CADJ,CAKH,CAN+B,CAA/B,CAMI,IAPL,EAjBJ,cA0BI,sCACI,0DADJ,cAEI,KAAC,wBAAD,EACI,EAAE,CAAE/B,EADR,CAEI,iBAAiB,CAAER,iBAFvB,CAGI,oBAAoB,CAAEC,oBAH1B,CAII,iBAAiB,CAAEW,iBAJvB,CAKI,YAAY,CAAEE,YALlB,CAMI,eAAe,CAAEC,eANrB,EAFJ,GA1BJ,CAoCKD,YAAY,eACb,UAAG,SAAS,CAAC,eAAb,UAA8BA,YAA9B,EArCJ,cAuCI,cAAO,IAAI,CAAC,QAAZ,CAAqB,KAAK,CAAC,gBAA3B,CAA4C,QAAQ,CAAEA,YAAY,CAAG,IAAH,CAAU,KAA5E,CAAmF,OAAO,CAAEY,YAA5F,EAvCJ,cAwCI,cAAO,IAAI,CAAC,QAAZ,CAAqB,KAAK,CAAC,QAA3B,CAAoC,OAAO,CAAEW,YAA7C,EAxCJ,GADJ,CA4CH,CA1HD,CA4HA,cAAevC,CAAAA,kBAAf","sourcesContent":["import React, {useEffect, useState} from 'react';\n\nimport {addActivityToRoutine, updateRoutine, getRoutineActivitiesByRoutineId, deleteRoutineActivity} from '../api';\nimport MyRoutinesActivitiesForm from './MyRoutinesActivitiesForm';\n\nconst MyRoutinesItemEdit = ({fetchData, pendingActivities, setPendingActivities, checkRoutineList, setToggle, toggle, name, goal, isPublic, id}) => {\n    const initialState = {\n        name: name,\n        goal: goal,\n        isPublic: isPublic,\n    }\n\n    const [form, setForm] = useState({...initialState})\n\n    const [routineActivities, setRoutineActivities] = useState([]);\n\n    const [errorMessage, setErrorMessage] = useState(null);\n\n    const fetchRoutineData = async () => {\n        try {\n            const fetchedRoutineActivities = await getRoutineActivitiesByRoutineId(id);\n            if (!fetchedRoutineActivities) return;\n            setRoutineActivities(fetchedRoutineActivities);\n        } catch (error) {\n            console.log(error);\n        }   \n    }\n\n    useEffect(() => {\n        fetchRoutineData();\n    }, [])\n\n    const handleFormChange = (event) => {\n        setForm({...form, [event.target.name]: event.target.value});\n    }\n\n    const handleOptionChange = (event) => {\n        let isPublicValue;\n        if (event.target.value == 'true') {\n            isPublicValue = true;\n        } else if (event.target.value == 'false') {\n            isPublicValue = false;\n        }\n        setForm({...form, isPublic: isPublicValue});\n    }\n\n    const handleSubmit = async (event) => {\n        event.preventDefault();\n        setErrorMessage('');\n        const {name, goal, isPublic} = form;\n        if (checkRoutineList(name) && name !== name) {\n            setErrorMessage('This routine already exists! Please choose another name.');\n            return;\n        }\n        try {\n            if (pendingActivities.length > 0) {\n                await Promise.all(\n                    pendingActivities.map(({routineId, activityId, count, duration}) => {\n                        addActivityToRoutine(routineId, activityId, count, duration);\n                    })\n                )\n            }\n            await updateRoutine(name, goal, isPublic, id);\n            setPendingActivities([]);\n            setToggle(!toggle);\n            fetchData();  \n        } catch (error) {\n            console.error(error);\n        }\n    }\n\n    const handleCancel = () => {\n        setToggle(!toggle);\n        setForm({...initialState});\n        setPendingActivities([]);\n        fetchData();\n    }\n\n    const handleDelete = async (routineActivityId) => {\n        await deleteRoutineActivity(routineActivityId);\n        fetchRoutineData();\n    }\n\n    return (\n        <form>\n            <h3>Edit Routine:</h3>\n            <label>\n                <span>Routine name: </span>\n                <input type='text' name='name' value={form.name} onChange={handleFormChange} />\n            </label>\n            <label>\n                <span>Routine goal: </span>\n                <input type='text' name='goal' value={form.goal} onChange={handleFormChange} />\n            </label>\n            <label>\n                <span>Share your routine?</span>\n                <div className='input-radio'>\n                    <input type='radio' name='isPublic' value='false' onChange={handleOptionChange} checked={form.isPublic === false} /> Private\n                    <input type='radio' name='isPublic' value='true' onChange={handleOptionChange} checked={form.isPublic === true}  /> Public    \n                </div>\n            </label>\n            <ul>\n            {routineActivities.length > 0 ? routineActivities.map(({name, count, duration, routineActivityId}) => {\n                return (\n                    <li key={routineActivityId}>\n                        <span className='material-icons' onClick={() => handleDelete(routineActivityId)}>delete</span> {name} ({count} {count > 1 ? 'reps' : 'rep'} for {duration} {duration > 1 ? 'mins' : 'min'})\n                    </li>\n                )\n            }) : null}\n            </ul>\n            <label>\n                <span>Add activities to your routine: </span>\n                <MyRoutinesActivitiesForm\n                    id={id}\n                    pendingActivities={pendingActivities}\n                    setPendingActivities={setPendingActivities}\n                    routineActivities={routineActivities}\n                    errorMessage={errorMessage}\n                    setErrorMessage={setErrorMessage} />\n            </label>\n            {errorMessage && (\n            <p className='error-message'>{errorMessage}</p>\n            )}\n            <input type='submit' value='Update routine' disabled={errorMessage ? true : false} onClick={handleSubmit} />\n            <input type='button' value='Cancel' onClick={handleCancel} />\n        </form>\n    )\n}\n\nexport default MyRoutinesItemEdit;"]},"metadata":{},"sourceType":"module"}